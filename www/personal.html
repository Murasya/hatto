<ons-page>
  <ons-bottom-toolbar>
    <div class="left" style="text-align: left;"><ons-back-button></ons-back-button></div>
    <div class="center">記録一覧</div>
  </ons-bottom-toolbar>
  <div id="userName_p"></div>
  <ons-list id="list_p"></ons-list>
  <script>
    ons.getScriptPage().onInit = function() {
      var db = firebase.firestore();
      db.collection("questionAndAnswer").where("uid", "==", this.data.id).where("public", "==", true).get().then(function(querySnapshot) {
        querySnapshot.forEach(function(doc) {
          var item = document.createElement("ons-list-item");
          item.textContent = doc.data().answers[0];
          item.setAttribute("tappable");
          item.onclick = function() {
            document.getElementById("myNavigator").pushPage('result.html', {
              data: {
                id: doc.id,
                questions: doc.data().questions,
                answers: doc.data().answers,
                main: doc.data().answers[0],
                public: doc.data().public,
                memo: doc.data().memo,
                tags: doc.data().tags,
                uid: doc.data().uid
              }
            });
          };
          document.getElementById("list_p").appendChild(item);
        });
      });

      var user = firebase.auth().currentUser;
      if (user) {
        var displayName = user.displayName;
        if(displayName){
          document.getElementById("userName_p").textContent = displayName;
        } else {
          document.getElementById("userName_p").textContent = "No Name";
        }
      } else {
      } 
    }
  </script>
</ons-page>